# 🚀 Works InsightHub

"사내 포털 **Works**와 연동되는 **AI 기반 문서 요약 및 질의응답 플랫폼**",
문서를 업로드하면, 요약과 추천은 AI가 자동으로 처리합니다.

--- 

## 1. 소개

### ✅ 핵심 슬로건  
_"Works InsightHub — 문서에서 인사이트까지, AI가 이어드립니다."_

### 🧠 개요
**Works InsightHub**는 사내 포털 **Works**의 Drive에서 업로드된 문서를 자동 수집하고,  
Azure 기반 AI 기술을 활용하여 문서 요약, 연관 문서 추천, 대화형 질의응답 기능을 제공하는 지능형 문서 허브입니다.

### 🧩 서비스 구성도

```plaintext
┌──────────────┐       업로드       ┌────────────┐        트리거 / API          ┌─────────────┐
│   Works      │ ───────────────▶ │   Drive     │ ─────────────────────────▶ │ InsightHub  │
│  (사내포털)   │                   │ (공동편집)  │                             │ Engine(API  │
└──────────────┘                   └────────────┘                              └─────────────┘
                                                                                │
                                                                                ▼
                                                                       ┌────────────────────┐
                                                                       │ Azure Blob Storage │
                                                                       └────────────────────┘
                                                                                │
                                                                                ▼
                                                                  ┌────────────────────────────┐
                                                                  │ Streamlit 기반 UI (Hub)    │
                                                                  └────────────────────────────┘
                                                                                │
                        ┌───────────────────────────────┬────────────────────────┴────────────────────────┐
                        ▼                               ▼                                                 ▼
              🔍 AI Search                    ✂️ 문서 요약                                             💬 GPT 채팅
           (유사도 기반 검색)            (PDF, DOCX, PPTX 등)                                     (대화형 질의응답)
```

### ✅ 주요 기능
 📥 Drive 문서 자동 연동
    사내 Works Drive에 업로드된 파일을 자동 감지 및 수집

 ✂️ 문서 자동 요약
    PDF, DOCX, PPTX, TXT 파일을 AI가 핵심만 추출해 요약

 🔍 AI 기반 문서 검색
    문서 내용을 벡터 임베딩 후 Azure AI Search를 통해 유사 문서 탐색

 💬 대화형 질의응답
    사용자가 질문하면 관련 문서와 함께 답변 생성 (출처 표시 + 하이라이팅)

 📧 이메일 전송
    문서 및 요약본을 이메일로 바로 전송 가능

### ✅ 타겟 사용자
- 팀 단위 협업을 진행하는 **부서**
- 프로젝트별 문서가 많고 **검색/요약이 번거로운 부서**
- AI 기반 **정보 요약·분석을 활용하려는 부서**

---

## 📊 2. 발표 구성

### 1. Intro
- _"왜 우리는 문서 정리와 공유에 시간을 낭비할까?"_
  → Cloud & AI시대 우리의 현실은? 사내 보안(DRM, 메신저 파일전송 불가, 네트워크 공유 불가) 및 KMS 부재, 검색엔진의 한계 등

### 2. Problem
- 문서가 많아질수록 **핵심 내용 파악이 어려움**
- 협업 시 **파일 공유와 정보 전달의 비효율**

### 3. Solution: Works InsightHub
- AI가 **요약, 추천, 공유(메일)**까지 지원하는 플랫폼

### 4. Key Features
- 문서 업로드(Drive 연동) → 자동 Indexing(벡터) 및 요약
- 문서 선택 → 문서 요약 및 추천
- 챗봇 → 채팅창을 통한 문서 기반 Q&A 및 GPT를 통한 지식 검색

### 5. Architecture
- **[Streamlit UI] + [Azure Blob] + [Azure AI Search] + [Azure OpenAI GPT] **
- 선택한 파일 → 텍스트 추출 → 요약 요청 → 결과 표시  

### 6. Demo
- 파일 업로드
- 선택한 문서 요약 결과 및 메일 발송
- 채팅 기반 RAG 적용(문서 정보 요약 or GPT 검색)

### 7. Future Roadmap
- 계정 관리 및 인증 처리
- Drive 문서 업로드 연동(API)
- ComputerVision(OCR 등) 이미지 처리
- 연관 문서 스마트 추천
- 사용자별 요약 튜닝
- 문서 열람 히스토리 적용
- 메일(SendMail) 전송
- 문서 목록 조회시 페이징 처리(문서가 많을 경우 성능 고려 필요)
- 일렉트론 기반 데스크톱 앱 개발
- 문서 보안 

---

## 📘 3. 서비스 명세서 (간략 버전)

### 📌 서비스명  
**Works InsightHub**

### 🛠️ 목적  
Azure Blob Storage에 저장된 문서를 기반으로 GPT 모델을 활용해 **문서 요약 및 추천 기능**을 제공.  
협업을 위한 **공유와 검색 기능**을 강화한 AI 문서 플랫폼.

### 🔐 주요 기술 스택
| 영역                   | 기술                                             | 설명                                                   |
| -------------------- | ---------------------------------------------- | ---------------------------------------------------- |
| **Frontend**         | `Streamlit`                                    | Python 기반 웹 UI 프레임워크. 파일 업로드, 채팅 UI, 실시간 인터랙션 구현     |
| **Backend**          | `Python 3.9+`                                  | 전체 앱 로직과 통합을 담당                                      |
| **Cloud Storage**    | `Azure Blob Storage`                           | 문서 업로드 및 저장, 파일 목록 조회, 다운로드 링크 제공                    |
| **AI 모델**            | `Azure OpenAI (GPT-4o, GPT-4o-mini)`           | 문서 요약 및 채팅 응답 생성. 사용자 질문에 대한 AI Search 결과 기반 보강      |
| **Document Parsing** | `python-docx`, `PyMuPDF (fitz)`, `python-pptx` | `docx`, `pdf`, `pptx` 파일에서 텍스트 추출                    |
| **메일 전송**            | `smtplib`, `EmailMessage`                      | 문서 첨부 후 이메일 전송 (예: Gmail SMTP 사용)                    |
| **환경설정 관리**          | `dotenv (.env)`                                | API 키, 연결 문자열 등 민감한 설정 외부 파일에서 로드                    |
| **AI Search**        | `Azure Cognitive Search API` 또는 REST 호출        | 내부 문서를 임베딩 후 유사도 기반 검색. 검색된 문서 chunk를 기반으로 GPT 응답 생성 |
| **하이라이팅 처리**         | `re (정규식) + HTML <mark>`                       | 검색된 chunk에서 사용자의 쿼리를 시각적으로 강조 표시                     |


### 🎯 핵심 기능 목록

| 기능명             | 설명 |
|------------------|------|
| 파일 업로드       | 사용자가 문서를 Blob Storage에 업로드 |
| 문서 목록 조회    | 업로드된 문서들을 리스트로 표시 |
| 파일 요약         | 선택한 문서 내용을 GPT를 통해 요약 |
| 채팅 인터페이스   | 사용자가 직접 질문하고 GPT로부터 답변 |
| 문서 추천         | 선택한 문서와 유사한 문서를 자동 추천 (예정) |
| 다운로드          | 업로드된 파일을 다시 다운로드 가능 |
| 보안 및 접근제어  | Azure 기반 스토리지 접근 제한 (기업 환경 대응) |
